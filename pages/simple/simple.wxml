<!-- pages/simple/simple.wxml -->
<view class="page-container" style="padding-top: {{statusBarHeight}}px;">

    <view class="title-container">
        <image class="title-image" src="/image/InvisibleFaceMask.png" mode="widthFix"></image>
    </view>

    <scroll-view class="scroll-container" scroll-y="true">
        <view class="container">
            <!-- 步骤一：智能上传/预览区域 -->
            <view class="upload-container">
                <view class="smart-upload-box" bindtap="chooseImage">   
                    <image class="smart-upload-bg-image" src="/image/simple_back.png" mode="aspectFill" /> 
                    <!-- 状态三：处理结果预览 -->
                    <block wx:if="{{processedImageList.length > 0}}">
                        <view class="preview-wrapper">
                            <text class="preview-title">处理结果预览（可点击重新上传）</text>
                            <view class="preview-grid">
                                <view wx:for="{{processedImageList}}" wx:key="*this" class="preview-item">
                                <image 
                                    src="{{item}}"
                                    class="preview-item-image" 
                                    mode="aspectFill"/>
                                </view>
                            </view>
                        </view>
                    </block>

                <!-- 状态二：正在处理中 -->
                <block wx:elif="{{isProcessing}}">
                    <view class="processing-placeholder">
                        <!-- 使用自定义的旋转图标 -->
                        <image 
                            class="processing-icon" 
                            src="/image/simple/process.png" 
                            mode="aspectFit"
                        />
                        <view class="processing-text">全力处理中...</view>
                    </view>
                </block>

                    <!-- 状态一：上传占位符 -->
                    <block wx:else>
                        <view class="upload-placeholder">
                            <view class="upload-text">点击上传图片</view>
                            <view class="upload-hint">单次最多9张图片</view>
                        </view>
                    </block>
                </view>
            </view>


            <!-- 新增：结果操作区 (始终显示) -->
            <view class="result-actions">
                <!-- 保存到相册 -->
                <button class="action-btn download-btn" bindtap="downloadImages"
                        disabled="{{processedImageList.length === 0 || isProcessing}}">
                    <image class="btn-icon" src="/image/simple/download.png" />
                    <text class="btn-label">保存到相册</text>
                </button>
                
                <!-- 分享给好友 -->
                <button class="action-btn share-friends-btn" open-type="share"
                        disabled="{{processedImageList.length === 0 || isProcessing}}">
                    <image class="btn-icon" src="/image/simple/share_friends.png" />
                    <text class="btn-label">分享给好友</text>
                </button>
                
                <!-- 分享朋友圈 -->
                <button class="action-btn share-timeline-btn" bindtap="shareToTimelineHandler"
                        disabled="{{processedImageList.length === 0 || isProcessing}}">
                    <image class="btn-icon" src="/image/simple/share.png" />
                    <text class="btn-label">分享朋友圈</text>
                </button>
            </view>


            <!-- 使用说明 (保持不变) -->
            <view class="usage-doc">
                <text class="doc-title">使用说明：</text>
                <view class="doc-note">*上传图片后自动处理</view>
                <view class="doc-item">1. 点击上方区域选择图片</view>
                <view class="doc-item">2. 处理选择后续操作</view>

            </view>
        </view>
    </scroll-view>
</view>