<!-- index.wxml -->
<navigation-bar title="Invisible FaceMask" back="{{false}}" color="black" background="#FFF"></navigation-bar>

<view class="container">
  

<!-- 图片上传与预览区域 -->
<view class="upload-container">
    <view class="upload-preview" bindtap="chooseImage">
        <!-- 如果有图片需要展示 -->
        <block wx:if="{{displayList.length > 0}}">
            <view class="preview-grid">
                <!-- 循环展示前三张图片 -->
                <image 
                    wx:for="{{displayList}}" 
                    wx:key="*this" 
                    src="{{item}}" 
                    class="preview-item-image" 
                    mode="aspectFill"
                />
            </view>
        </block>

        <!-- 如果没有图片，则显示上传占位符 -->
        <view wx:else class="upload-placeholder">
            <text class="upload-text">点击上传图片</text>
            <text class="upload-hint">支持jpg/png格式，最多20张</text>
        </view>
    </view>

    <!-- 提示选择了多少张图片 -->
    <view wx:if="{{imageList.length > 0}}" class="image-count-hint">
        已选择 {{imageList.length}} 张图片
        <block wx:if="{{imageList.length > 3}}">，仅显示前3张</block>
    </view>
</view>








  
  <!-- 输出图片 -->
  <view class="output">
          <!-- 如果有图片需要展示 -->
        <block wx:if="{{displayList.length > 0}}">
            <view class="preview-grid">
                <!-- 循环展示前三张图片 -->
                <image 
                    wx:for="{{displayList}}" 
                    wx:key="*this" 
                    src="{{item}}" 
                    class="preview-item-image" 
                    mode="aspectFill"
                />
            </view>
        </block>
    <image src="{{processedImagePath}}" class="processed-preview"  mode="aspectFit"/>
      <!-- 合并后的操作按钮 -->
    <view class="action-buttons">
        <button class="process-btn" bindtap="processImage">处理图片</button>
        <button class="download-btn" bindtap="downloadImage">下载图片</button>
    </view>
  </view>





    <view class="usage-doc">
        <text class="doc-title">使用说明：</text>
        <!-- 将单行文本拆分为独立块级元素 -->
        <view class="doc-item">1. 点击上传区域选择JPG/PNG格式图片</view>
        <view class="doc-item">2. 点击"处理图片"注入防御性噪声</view>
        <view class="doc-item">3. 下载处理后图片用于安全分享</view>
        <view class="doc-note">* 噪声强度自动适配图片分辨率</view>
    </view>

</view>
